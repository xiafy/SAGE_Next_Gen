#!/bin/bash
# Codex ä¸šåŠ¡é€»è¾‘ + ä»£ç  Review å¯åŠ¨è„šæœ¬
# ä½¿ç”¨ heredoc é¿å…å¼•å·é—®é¢˜

TASK=$(cat << 'ENDTASK'
ä½ æ˜¯ä¸€åèµ„æ·±å…¨æ ˆå·¥ç¨‹å¸ˆï¼ŒåŒæ—¶ç†Ÿæ‚‰äº§å“è®¾è®¡ã€‚è¯·å¯¹ SAGE MVP çš„ Worker å’Œ App ä»£ç è¿›è¡Œå…¨é¢å®¡æŸ¥ã€‚

ä»£ç ä½äºï¼š
- worker/ ç›®å½• â€” Cloudflare Worker API æœåŠ¡ï¼ˆTypeScriptï¼‰
- app/src/ ç›®å½• â€” React + TypeScript å‰ç«¯

å…³é”®äº§å“å†³ç­–ï¼ˆå¯¹ç…§æ£€æŸ¥ï¼‰ï¼š
- DEC-019ï¼šè¯†åˆ«å¤±è´¥åªå¼•å¯¼é‡æ‹ï¼Œä¸åšæ–‡å­—è¾“å…¥å…œåº•
- DEC-020ï¼šAI å“åº”ä¸­ç»å¯¹ä¸èƒ½æœ‰ agentRole / agentGreeting å­—æ®µ
- DEC-021ï¼šGPS è¢«æ‹’æ—¶é™é»˜è·³è¿‡ï¼Œé›¶ UI æç¤º
- DEC-027ï¼šPre-Chat â†’ Handoff â†’ ä¸» Chat ä¸‰é˜¶æ®µï¼Œä¸» Chat ä¸é‡å¤é—®å·²å›ç­”é—®é¢˜
- DEC-028ï¼šæ‰€æœ‰ Bailian API è°ƒç”¨å¿…é¡»æœ‰ enable_thinking: falseï¼ˆè¿åä¼šå¯¼è‡´ TTFT 7-26sï¼‰
- chatPhase çŠ¶æ€æœºï¼špre_chat â†’ handing_off â†’ chattingï¼ˆæˆ– failedï¼‰

å®¡æŸ¥ç»´åº¦ï¼š
1. ä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§ï¼šPre-Chatâ†’Handoffâ†’ä¸»Chatæµç¨‹ï¼ŒIcebreakeræœ¬åœ°ç”Ÿæˆï¼Œè¯†åˆ«å¤±è´¥å¤„ç†
2. APIå¥‘çº¦ä¸€è‡´æ€§ï¼šWorkerè¯·æ±‚/å“åº”ä¸Appè°ƒç”¨æ˜¯å¦å¯¹é½ï¼ŒSSEæ ¼å¼æ˜¯å¦ä¸€è‡´
3. çŠ¶æ€ç®¡ç†ï¼šchatPhaseè½¬æ¢ï¼ŒAbortControlleræ¸…ç†ï¼ŒorderItemsæ“ä½œ
4. é”™è¯¯å¤„ç†ï¼šSSEæ–­æµã€AIè¿”å›éJSONã€ç½‘ç»œè¶…æ—¶ã€é˜²é‡å¤æäº¤
5. å®‰å…¨æ€§èƒ½ï¼šAPI Keyéš”ç¦»ï¼Œenable_thinking=falseï¼ŒCORSï¼Œé€Ÿç‡é™åˆ¶ï¼Œå¤§èœå•é‡‡æ ·
6. TypeScriptè´¨é‡ï¼šanyç±»å‹ï¼Œæœªå¤„ç†çš„Promiseï¼ŒuseEffectä¾èµ–

è¾“å‡ºæ ¼å¼ï¼ˆä¸¥æ ¼éµå®ˆï¼‰ï¼š
# SAGE MVP Code Review æŠ¥å‘Š

## ğŸ”´ ä¸¥é‡é—®é¢˜ï¼ˆå¿…é¡»ä¿®å¤ï¼‰
[ç¼–å·] æ ‡é¢˜
  ä½ç½®: æ–‡ä»¶:è¡Œå·
  å½±å“: ...
  ä¿®å¤å»ºè®®: ...

## ğŸŸ¡ ä¸­ç­‰é—®é¢˜ï¼ˆåº”è¯¥ä¿®å¤ï¼‰
[ç¼–å·] æ ‡é¢˜
  ä½ç½®: ...
  ä¿®å¤å»ºè®®: ...

## ğŸŸ¢ è½»å¾®é—®é¢˜ï¼ˆå»ºè®®ä¼˜åŒ–ï¼‰
[ç¼–å·] æ ‡é¢˜
  ä¿®å¤å»ºè®®: ...

## âœ… åšå¾—å¥½çš„åœ°æ–¹
- ...

## ğŸ“Š æ€»ä½“è¯„åˆ†
- ä¸šåŠ¡é€»è¾‘æ­£ç¡®æ€§: X/10
- APIå¥‘çº¦ä¸€è‡´æ€§: X/10
- é”™è¯¯å¤„ç†å®Œæ•´æ€§: X/10
- ä»£ç è´¨é‡: X/10
- ç»¼åˆ: X/10

## ä¼˜å…ˆä¿®å¤é¡ºåº
1. ...

å°†æŠ¥å‘Šå†™å…¥æ–‡ä»¶ 05_implementation/REVIEW_REPORT.mdï¼Œç„¶åè¾“å‡ºï¼šREVIEW_DONE
ENDTASK
)

codex exec --full-auto "$TASK"
