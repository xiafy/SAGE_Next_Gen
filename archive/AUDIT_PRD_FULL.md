# SAGE PRD 全量审计任务

## 审计目标
按照 PRD.md v1.4 逐条评审 F01-F10 所有功能的业务逻辑和代码实现一致性。

## 审计范围
1. **F01 Home** - 首屏、设置入口、动态问候语、无历史记录
2. **F02 Scanner** - 全屏相机、最多 5 张、双入口、HEIC 支持、压缩<2MB
3. **F03 菜单识别** - 9 种语言、失败降级处理、zod 校验
4. **F04 感知系统** - 时间 (A)/GPS(B 静默)/记忆 (D)
5. **F06 AgentChat** - Pre-Chat 机制、Handoff、快捷按钮、垂直推荐卡片
6. **F07 探索视图** - 分类 Tab、双语、加入点餐单、返回对话
7. **F08 点餐单** - 数量调整、展示模式 (原文大字、屏幕常亮)
8. **F09 偏好管理** - 自动学习、设置页可编辑删除
9. **F10 语言切换** - 自动检测 + 手动切换、持久化

## 审计检查点

### 代码层面
1. 每个功能的 AC（验收标准）是否全部实现
2. 前后端契约是否对齐（类型/字段名/结构）
3. 错误处理是否完整（边界情况、失败路径）
4. 状态机转换是否完整（无死路、无永久 stuck 状态）

### 业务逻辑层面
1. 是否符合 PRD 描述的用户旅程
2. 是否符合 CLAUDE.md 的核心设计哲学（Goal>Process, Scenario-Free 等）
3. 是否符合 DECISIONS.md 的关键决策

### 文档层面
1. PROGRESS.md 当前状态是否与实际代码一致
2. EXECUTION_STATE.md 任务队列状态是否正确

## 审计方法
1. 读取 PRD.md 每个功能的验收标准
2. 检查 05_implementation/app/src/ 对应代码
3. 检查 05_implementation/worker/ 对应 API
4. 输出审计报告，标注🔴严重/🟡中等/🟢轻微/✅优秀

## 输出格式
审计报告写入 AUDIT_PRD_REPORT.md，格式：
```
## F01 Home
- AC1: ✅ 通过 / ❌ 失败 + 说明
- AC2: ...
问题：[描述]
建议：[修复方案]
```

完成后输出：AUDIT_DONE
